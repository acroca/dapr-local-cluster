load('ext://uibutton', 'cmd_button')

# Workflows service (Go)
docker_build('localhost:5001/workflows-crossapp1', './app1')
docker_build('localhost:5001/workflows-crossapp2', './app2')
docker_build('localhost:5001/workflows-crossapp3', './app3')
k8s_yaml('manifests/deployment1.yaml')
k8s_yaml('manifests/deployment2.yaml')
k8s_yaml('manifests/deployment3.yaml')
k8s_resource(workload='workflows-crossapp1', resource_deps=['dapr'], labels=['apps'], port_forwards=['6008:6008'])
k8s_resource(workload='workflows-crossapp2', resource_deps=['dapr'], labels=['apps'], port_forwards=['6009:6009'])
k8s_resource(workload='workflows-crossapp3', resource_deps=['dapr'], labels=['apps'], port_forwards=['6010:6010'])

cmd_button('workflows-crossapp1:start',
            argv=['sh', '-c', 'curl --silent -X POST http://localhost:6008/start'],
            resource='workflows-crossapp1',
            icon_name='cloud_download',
            text='start workflow',
)
cmd_button('workflows-crossapp3:start',
            argv=['sh', '-c', 'curl --silent -X POST http://localhost:6010/start'],
            resource='workflows-crossapp3',
            icon_name='cloud_download',
            text='start workflow',
)
